#!/usr/bin/env perl
#
use lib '/var/mobile/scripts/lib/perl5';
use PAR '/var/mobile/scripts/lib/perl5/lib.par';
use JSON::Tiny qw(decode_json);
use Term::ANSIColor;
use feature qw/say/;

use HTTP::Tiny;

die "Usage:\n\n\ mcpq <Module::Name>\n\n" unless @ARGV;

my $pm_request='http://metacpan.org/search/autocomplete?q='."$ARGV[0]";
my $get_jsonn = HTTP::Tiny->new->get("$pm_request");
die "Failed!\n" unless $mcp_url->{success};
print $mcp_url->{content} if length $mcp_url->{content};

die;
my $j=`$jurl$pm_req  2>/dev/null`;
if ($ARGV[1] eq '-j') { print "$j\n" } 
    else { jparse() }
sub jparse {
    my $p=decode_json $j;
    my $i==1;
    print ">>Results\n";
    for my $dist (@$p) {
        if ($i % 2) {
            print colored(qq!$$dist{'distribution'}!, q!blue on_black!);
        } else {
            print colored(qq!$$dist{'distribution'}!, q!bright_blue on_black!);
        }
        print colored(qq!\ \:\:\ !, q!red on_black!);
        $i++;
    }
#    print colored(qq!\n\n>>Use!, q!on_black!); 
#    print colored(qq! -i !, q!white on_black!);
#    print colored(qq!as a second parameter to build and install module!, q!on_black!);
    print "\n";
}
#print Dumper ($p{'distribution'});
